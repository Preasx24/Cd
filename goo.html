<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Encrypt Story</title>
<style>
body { font-family: Arial; margin: 20px; }
input, button { margin: 0.5rem 0; padding: 0.5rem; }
textarea { width: 100%; height: 150px; margin-top: 1rem; }
</style>
</head>
<body>
<h2>Encrypt Your Story</h2>

<input type="file" id="fileInput" accept=".txt"><br>
<input type="password" id="pass" placeholder="Enter passphrase"><br>
<button id="encryptBtn">Encrypt and Download</button>

<h3>Encrypted Content:</h3>
<textarea id="output" readonly></textarea>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script>
document.getElementById('encryptBtn').addEventListener('click', () => {
    const fileInput = document.getElementById('fileInput').files[0];
    const pass = document.getElementById('pass').value;
    if (!fileInput) { alert("Choose a .txt file"); return; }
    if (!pass) { alert("Enter a passphrase"); return; }

    const reader = new FileReader();
    reader.onload = function(e) {
        const text = e.target.result;
        const encrypted = CryptoJS.AES.encrypt(text, pass).toString();
        document.getElementById('output').value = encrypted;

        // Download file with the same name as input
        const downloadName = fileInput.name;

        const blob = new Blob([encrypted], {type: 'text/plain'});
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = downloadName;
        link.textContent = 'Download Encrypted File';
        link.style.display = 'block';
        document.body.appendChild(link);
    };
    reader.readAsText(fileInput);
});
</script>
</body>
</html>